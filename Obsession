if game.Workspace:FindFirstChild("SeekMovingNewClone") then
    return
end

function LoadCustomInstance(url, Name)
    if not isfile(Name .. ".rbxm") then
        writefile(Name .. ".rbxm", game:HttpGet(url))
    end

    return game:GetObjects(getcustomasset(Name .. ".rbxm", true))[1]
end

task.wait(0.7)

local Rooms = game.Workspace.CurrentRooms:GetChildren()
local LastRoom = Rooms[#Rooms - 1]

local ObsessionModel =
    LoadCustomInstance(
    "https://github.com/Jahani-john/mayhem-mode/raw/refs/heads/main/mayhemmode-main/Greed.Obssesion.rbxm",
    "Obession_model"
)
ObsessionModel.Parent = game.Workspace

local Obsession = ObsessionModel.ObsessionNew
Obsession.CFrame = LastRoom.Parts.Floor.CFrame + Vector3.new(0, 5, 0)

print("cframe")

for i = 1, #LastRoom.Assets:GetChildren(), 1 do
    print("one time")
    local asset = LastRoom.Assets:GetChildren()[i]
    if asset then
        if asset.Name == "Chandelier" or asset.Name == "Light_Fixtures" then
            asset:Destroy()
        end
    end
end

print("lights destroyed")

LastRoom:SetAttribute("Ambient", Color3.new(0, 0, 0))

while game.ReplicatedStorage.GameData.LatestRoom.Value == tonumber(LastRoom.Name) do
    task.wait(0.1)
    local _, Looking = game.Workspace.CurrentCamera:WorldToViewportPoint(Obsession.Position)
    if not Looking then
        game.Players.LocalPlayer.Character.Humanoid:TakeDamage(5)
        if game.Players.LocalPlayer.Character.Humanoid.Health <= 1 then
            firesignal(
                game.ReplicatedStorage.RemotesFolder.DeathHint.OnClientEvent,
                {
                    "Oh... hello.",
                    "Not this place again...",
                    "Nevermind that... What'd you die to?",
                    "Oh... that thing.",
                    "It really wants attention",
                    "Maybe you could call it Obsession?",
                    "Anyways, I hope you don't mind trying again. It would be helpful."
                },
                "Yellow"
            )
            game.ReplicatedStorage.GameStats["Player_" .. game.Players.LocalPlayer.Name].Total.DeathCause.Value =
                "Obsession"
        end
    end
end

ObsessionModel:Destroy()
